<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace는 @Mapper를 지정한다. -->
<mapper namespace="com.gdu.book.mapper.EmployeeListMapper">

	<!-- DEPARTMENTS와 EMPLOYEES의 JOIN 결과를 저장할 resultMap 만들기 -->
	<resultMap type="EmpDTO" id="EmpMap">
		<id column="EMPLOYEE_ID" property="employeeId"/>
		<result column="FIRST_NAME" property="firstName"/>
		<result column="LAST_NAME" property="lastName"/>
		<result column="EMAIL" property="email"/>
		<result column="PHONE_NUMBER" property="phoneNumber"/>
		<result column="HIRE_DATE" property="hireDate"/>
		<result column="JOB_ID" property="jobId"/>
		<result column="SALARY" property="salary"/>
		<result column="COMMISSION_PCT" property="commissionPct"/>
		<result column="MANAGER_ID" property="managerId"/>
		<association javaType="DeptDTO" property="deptDTO">
			<id column="DEPARTMENT_ID" property="departmentId"/>
			<result column="DEPARTMENT_NAME" property="departmentName"/>
			<result column="MANAGER_ID" property="managerId"/>
			<result column="LOCATION_ID" property="locationId"/>
		</association>
	</resultMap>

	<select id="getTotalRecord">
		SELECT COUNT(*)
		  FROM EMPLOYEES
	</select>
	
	<select id="getEmployeeList">
		SELECT RN, EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_NAME
		  FROM (SELECT ROW_NUMBER() OVER(ORDER BY EMPLOYEE_ID ASC) AS RN, EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_NAME)
	</select>
	


</mapper>